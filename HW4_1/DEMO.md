# Demo Walkthrough
This file walks through the steps for demo'ing the code in this assignment.

## Running the capsule
The "capsule.sh" script utilizes a tar.gz image file as an input, and runs variations on the commands mentioned in the primary readme to create two new containers, named "hw4a" and "hw4b" from the "hw4_image.tar.gz" file generated by following the steps in the main README. Use the command below to run the capsule.

```./capsule.sh <tar file>```

## Running the Containers
To run the containers, two command windows are needed. Run each of the following commands, one in each window.

```lxc exec hw4a -- unshare --mount --fork --pid --mount-proc /bin/bash```

```lxc exec hw4b -- unshare --mount --fork --pid --mount-proc /bin/bash```

## Connecting to an Internet Server
To demonstrate connecting to an internet server, a program has been written which both pings "www.google.com" and then executes a send/receive with the website. To run this file, execute the following commands in either container.

```cd /jailed/apps/```

```./connect_to_server_internet```

The file will print some high-level information to the console, but all detailed information from the pings and the send/receive is written to a file "server_output.txt", located in the same working directory.

## TCP Client-Server Communication Between Containers
To demonstrate the creation of a tcp client-server communication between two processes in two different capsules two programs were written - one client and one server - to be executed inside of each capsule. When both are running, the programs allow for short messages to be sent back and forth over the connection. By default these programs are communicating over port 80.

First, inside of container "hw4a" the server program will be run. This can be done using the following commands inside of the bash for "hw4a".

```cd /dailed/apps/```

```/./server_hw4a```

Text will print to the window to indicate the server is running and waiting.

Then, inside of container "hw4b" the client program will be run. This program takes an argument of the IP address of the server, which can be retrieved using the ```lxc list``` command which will give similar output as follows:

```+------+---------+-----------------------+-----------------------------------------------+------------+-----------+```

```| NAME |  STATE  |         IPV4          |                     IPV6                      |    TYPE    | SNAPSHOTS |```

```+------+---------+-----------------------+-----------------------------------------------+------------+-----------+```

```| hw4a | RUNNING | 10.241.195.226 (eth0) | fd42:789a:6bbe:ab48:216:3eff:fee3:e2ec (eth0) | PERSISTENT | 0         |```

```+------+---------+-----------------------+-----------------------------------------------+------------+-----------+```

```| hw4b | RUNNING | 10.241.195.110 (eth0) | fd42:789a:6bbe:ab48:216:3eff:fe5f:7436 (eth0) | PERSISTENT | 0         |```

```+------+---------+-----------------------+-----------------------------------------------+------------+-----------+```

Since the server is running in hw4a, we will use the IPV4 address of hw4a as the argument to run the client.

```./client_hw4b <IP Address>```

Upon connection the console in both programs will then prompt the user to enter a short message, after pressing 'Enter' the message will be printed to the server's console, and any messages from the server's console will be printed to the client's console.

## Cleaning the Lxc Workspace
Another script was created to clean the lxc workspace from any images or containers present. Simple run the script as show below to clean.

```./cleanup_capsule.sh```

